Hanabira.org - Japanese Databases Audit & Seeding Note
=====================================================

Date: 2025-10-28

Scope
- Dictionary static DB (jmdictDatabase)
- Express static DB (zenRelationshipsAutomated): kanji, tanoswords, sentences, grammars, reading, etc.
- File-based resources: KANJIDIC2 JSON, radicals_wikipedia JSON

Checks Performed
1) JMDICT (jmdictDatabase)
   - Count: 367,619 entries (OK)
   - Simplified files present: 50+ (OK)
   - Spot-checks: entries found for 食べる, 猫 (OK)

2) Express DB (zenRelationshipsAutomated)
   - Collection counts:
     - kanji: 345 (OK)
     - tanoswords: 59,276 (OK)
     - sentences: 5,281 (OK)
     - grammars: 828 (OK)
     - reading: 10 (OK)
     - krgrammars: 744; vngrammars/thgrammars/cngrammars: 0 (expected)
   - Data files in container:
     - /app/kanji/: n3/n4/n5 JSON present (OK)
     - /app/reading/: JLPT_N3_reading_01..10.json present (OK)

3) File resources inside dictionary container
   - /app/kanjidic/kanjidic2.json (~30 MB) (OK)
   - /app/radicals_wikipedia/radicals_wikipedia.json (OK)

Actions Taken
- None required; all core Japanese resources are present and seeded.

If Seeding Needed (reference)
- JMDICT seeding (inside dictionary container):
  docker exec hanabiraorg-dictionary-db-1 node /app/streamline_jmdict_json.js
  docker exec hanabiraorg-dictionary-db-1 node /app/seed_jmdict_data.js
  docker exec hanabiraorg-dictionary-db-1 mongosh jmdictDatabase --quiet --eval "db.entries.countDocuments()"

- Express seeding (runs via wrapper on container start). Manually:
  docker exec hanabiraorg-express-db-1 node /app/seeding_scripts/seed_kanji_to_db.js
  docker exec hanabiraorg-express-db-1 node /app/seeding_scripts/seed_reading_to_db.js
  docker exec hanabiraorg-express-db-1 node /app/seeding_scripts/seed_grammar_to_db.js
  docker exec hanabiraorg-express-db-1 node /app/seeding_scripts/seed_tanos_vocab_to_db.js

Follow-ups (optional)
- Consider enabling Mongo auth for production
- Tune host kernel params (vm.max_map_count, swappiness) for performance


Additional Databases on Each Mongo Instance
------------------------------------------

Dictionary container (hanabiraorg-dictionary-db-1):
- admin (system)
- config (system)
- jmdictDatabase (seeded)
- local (system)

Express container (hanabiraorg-express-db-1):
- admin (system)
- config (system)
- local (system)
- zenRelationshipsAutomated (seeded)

Flask container (hanabiraorg-flask-dynamic-db-1):
- admin (system)
- config (system)
- local (system)
- flaskFlashcardDB (dynamic)
- login_db (dynamic)
